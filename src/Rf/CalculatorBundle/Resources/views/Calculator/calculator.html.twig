{% extends 'RfCalculatorBundle::layout.html.twig' %}

{% block top_left %}
    <div class="amu_container_l">
        <input type='checkbox' class='amu_input hidden_input' id='amu_beast_l' name='amu[amu_beast_l]' value='28'/>
        <label for='amu_beast_l'  class='amu_beast buff' title="fluctuating beast vital's Earring"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu_oc_l' name='buff[amu_oc_l]' value='28'/>
        <label for='amu_oc_l'  class='amu_oc buff' title="Outcasted marauder's Earring"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu_sk_l' name='buff[amu_sk_l]' value='30'/>
        <label for='amu_sk_l'  class='amu_sk buff' title="Stormknife Claw's Necklace"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu_starved_l' name='buff[amu_starved_l]' value='28'/>
        <label for='amu_starved_l'  class='amu_starved buff' title="Starved Beast's Earring"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu_vio_l' name='buff[amu_vio_l]' value='28'/>
        <label for='amu_vio_l'  class='amu_vio buff' title="violent wild's Earring"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu25_l' name='buff[amu25_l]' value='25'/>
        <label for='amu25_l'  class='amu25 buff' title='Elemental Hue Headset'></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu20_l' name='buff[amu20_l]' value='20'/>
        <label for='amu20_l'  class='amu20 buff' title='Elemental Pliant Headset'></label>
    </div>
    <div class="amu_container_r">
        <input type='checkbox' class='amu_input hidden_input' id='amu_beast_r' name='amu[amu_beast_r]' value='28'/>
        <label for='amu_beast_r'  class='amu_beast buff' title="fluctuating beast vital's Earring"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu_oc_r' name='buff[amu_oc_r]' value='28'/>
        <label for='amu_oc_r'  class='amu_oc buff' title="Outcasted marauder's Earring"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu_sk_r' name='buff[amu_sk_r]' value='30'/>
        <label for='amu_sk_r'  class='amu_sk buff' title="Stormknife Claw's Necklace"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu_starved_r' name='buff[amu_starved_r]' value='28'/>
        <label for='amu_starved_r'  class='amu_starved buff' title="Starved Beast's Earring"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu_vio_r' name='buff[amu_vio_r]' value='28'/>
        <label for='amu_vio_r'  class='amu_vio buff' title="violent wild's Earring"></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu25_r' name='buff[amu25_r]' value='25'/>
        <label for='amu25_r'  class='amu25 buff' title='Elemental Hue Headset'></label>

        <input type='checkbox' class='amu_input hidden_input' id='amu20_r' name='buff[amu20_r]' value='20'/>
        <label for='amu20_r'  class='amu20 buff' title='Elemental Pliant Headset'></label>
    </div>
    <div class="ring_container_l">
        <input type='checkbox' class='ring_input hidden_input' id='ring25_l' name='buff[ring25_l]' value='25'/>
        <label for='ring25_l'  class='ring25 buff' title='Elemental Hue Bracers'></label>

        <input type='checkbox' class='ring_input hidden_input' id='ring20_l' name='buff[ring20_l]' value='20'/>
        <label for='ring20_l'  class='ring20 buff' title='Elemental Pliant Bracers'></label>
    </div>
    <div class="ring_container_r">
        <input type='checkbox' class='ring_input hidden_input' id='ring25_r' name='buff[ring25_r]' value='25'/>
        <label for='ring25_r'  class='ring25 buff' title='Elemental Hue Bracers'></label>

        <input type='checkbox' class='ring_input hidden_input' id='ring20_r' name='buff[ring20_r]' value='20'/>
        <label for='ring20_r'  class='ring20 buff' title='Elemental Pliant Bracers'></label>
    </div>
{% endblock %}

{% block top_center %}
    <div class='rf_main'>

        <div class='result_container'>
            <span>
                <img src='{{ asset('bundles/rfcalculator/images/none.png') }}' id='result_image'/>
            </span>
            <div>Item Name : <span id='result_name'>-</span></div>
            <div id='result_weapon_container'>Damage : <span id='result_atk_min'>1</span> - <span id='result_atk_max'>1</span></div>
            <div id='result_buff_container'>Buff : <span id='result_buff'>0</span>%</div>
        </div>
        
        <div class='upgrade_container'>
            {% set percentages = {7 : 200, 6 : 135, 5: 80, 4 : 50, 3 : 25, 2: 13, 1 : 5} %}
            {% for i, percent in percentages %}
                <input type='radio' class='upgrade_input hidden_input' id='upgrade{{ i }}' name='upgrade' value='{{ percent }}'/>
                <label for='upgrade{{ i }}'  class='upgrade_label'></label>
            {% endfor %}
        </div>

        <div>
            <span class='reset'>reset</span>
        </div>
    </div>
{% endblock %}

{% block top_right %}
    <div class="launcher">
        <input type='radio' class='weapon_input hidden_input' name='weapon' id='hora_akeron' data-name='Hora Akeron' value='1265-2714'/>
        <label for='hora_akeron'  class='hora_akeron weapon' title='Hora Akeron'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='hora_akeron_b' data-name='Intense Hora Akeron' value='1671-3556'/>
        <label for='hora_akeron_b'  class='hora_akeron weapon' title='Intense Hora Akeron'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='dfl' data-name='Dark Flame Launcher' value='1638-3563'/>
        <label for='dfl'  class='dfl weapon' title='Dark Flame Launcher'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='dfl_b' data-name='Intense Dark Flame Launcher' value='2036-4408'/>
        <label for='dfl_b'  class='dfl weapon' title='Intense Dark Flame Launcher'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='div_fl' data-name='Divine Frame Launcher' value='2113-4667'/>
        <label for='div_fl'  class='dfl weapon' title='Divine Frame Launcher'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='div_fl_b' data-name='Divine Frame Launcher [Rare B]' value='2482-5465'/>
        <label for='div_fl_b'  class='dfl weapon' title='Divine Frame Launcher [Rare B]'></label>
    </div>
    <div class="lance">
        <input type='radio' class='weapon_input hidden_input' name='weapon' id='hora_spear' data-name='Hora Spear' value='1484-2280'/>
        <label for='hora_spear'  class='hora_spear weapon' title='Hora Spear'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='hora_spear_b' data-name='Intense Hora Spear' value='1960-2980'/>
        <label for='hora_spear_b'  class='hora_spear weapon' title='Intense Hora Spear'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='black_lance' data-name='Black Lance' value='1960-2980'/>
        <label for='black_lance'  class='black_lance weapon' title='Black Lance'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='black_lance_b' data-name='Intense Black Lance' value='2036-4408'/>
        <label for='black_lance_b'  class='black_lance weapon' title='Intense Black Lance'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='divine_lance' data-name='Divine Lance' value='2587-3874'/>
        <label for='divine_lance'  class='black_lance weapon' title='Divine Lance'></label>

        <input type='radio' class='weapon_input hidden_input' name='weapon' id='divine_lance_b' data-name='Divine Lance [Rare B]' value='2036-4408'/>
        <label for='divine_lance_b'  class='black_lance weapon' title='Divine Lance [Rare B]'></label>
    </div>
{% endblock %}

{% block bottom_container %}
    <div class="buff_container">
        <input type='checkbox' class='buff_input hidden_input' id='wild_rage' name='buff[wild_rage]' value='30'/>
        <label for='wild_rage'  class='wild_rage buff' title='Wild Rage'></label>

        <input type='checkbox' class='buff_input hidden_input' id='magnetic_arm' name='buff[magnetic_arm]' value='30'/>
        <label for='magnetic_arm'  class='magnetic_arm buff' title='Magnetic Arm'></label>

        <input type='checkbox' class='buff_input hidden_input' id='siege_mastery' name='buff[siege_mastery]' value='50'/>
        <label for='siege_mastery'  class='siege_mastery buff' title='Siege Mastery'></label>

        <input type='checkbox' class='buff_input hidden_input' id='od20' name='buff[od20]' value='20'/>
        <label for='od20'  class='od20 buff' title='Advanced Over Drive Charger'></label>

        <input type='checkbox' class='buff_input hidden_input' id='od40' name='buff[od40]' value='40'/>
        <label for='od40'  class='od40 buff' title='Offense Charger'></label>

        <input type='checkbox' class='buff_input hidden_input' id='od55' name='buff[od55]' value='55'/>
        <label for='od55'  class='od55 buff' title='Offense Charger [Premium]'></label>

        <input type='checkbox' class='buff_input hidden_input' id='od70' name='buff[od70]' value='70'/>
        <label for='od70'  class='od70 buff' title='Roast Sweet Potato'></label>
    </div>
    <div class="siege_container">
        <input type='checkbox' class='buff_input hidden_input' id='red_siege_1' name='buff[red_siege_1]' value='40'/>
        <label for='red_siege_1'  class='red_siege buff' title='Attack Ephocal Siege Kit'></label>

        <input type='checkbox' class='buff_input hidden_input' id='red_siege_2' name='buff[red_siege_2]' value='10'/>
        <label for='red_siege_2'  class='red_siege buff' title='Defense Ephocal Siege Kit'></label>

        <input type='checkbox' class='buff_input hidden_input' id='blue_siege' name='buff[blue_siege]' value='60'/>
        <label for='blue_siege'  class='blue_siege buff' title='Sniper Lecas Siege Kit'></label>

        <input type='checkbox' class='buff_input hidden_input' id='black_siege_1' name='buff[black_siege_1]' value='45'/>
        <label for='black_siege_1'  class='black_siege buff' title='Shining Siege Kit'></label>

        <input type='checkbox' class='buff_input hidden_input' id='black_siege_2' name='buff[black_siege_2]' value='40'/>
        <label for='black_siege_2'  class='black_siege buff' title='Advanced Shining Siege Kit'></label>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type='text/javascript'>
        var trigger = function() {
            $.ajax({
                type: 'get',
                url: '/calculate',
                data: $('form').serialize(),
                success: function(json) {
                    $('#result_atk_min').text(json.totalMin);
                    $('#result_atk_max').text(json.totalMax);
                    $('#result_buff').text(json.buff);
                }
            });
        };
        var resetInfo = function() {
            $('#result_name').text('-');
            $('#result_image').attr('src', "{{ asset('bundles/rfcalculator/images/none.png') }}");
            $('#buff').val(0);
            $('#result_buff').text('0');
            $('.weapon_input').filter(':checked').prop('checked', false);
            $('.upgrade_input').filter(':checked').prop('checked', false);
            $('.buff_input').filter(':checked').prop('checked', false);
        }
        $('.weapon_input').on('change', function() {
            $('#result_name').text($(this).data('name'));
            $('#result_image').attr('src', $(this).find('img').attr('src'));
            trigger();
        });
        $('.upgrade_input').on('change', function() {
            trigger();
        });
        $('.buff_input').on('change', function() {
            trigger();
        });
        $('.amu_input').on('change', function() {
            trigger();
        });
        $('.ring_input').on('change', function() {
            trigger();
        });
        $('.reset').on('click', function() {
            resetInfo();
            trigger();
        });
        $(function() {
            $( document ).tooltip({
                content: function() {
                    var result = '<div>' + $(this).attr('title') + '</div>';
                    if ($(this).hasClass('buff')) {
                        result += '<div>Damage: ' + $(this).prev().val() + '%</div>';
                    }
                    else if ($(this).hasClass('weapon')) {
                        result += '<div>Damage: ' + $(this).prev().val() + '</div>';
                    }
                    return result;
                }
            });
        });
    </script>
{% endblock %}